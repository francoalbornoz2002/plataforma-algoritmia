generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Rol {
  ADMIN //Pendiente de migración
  DOCENTE
  ALUMNO
}

enum Modalidad {
  PRESENCIAL
  VIRTUAL
}

enum DiaDeSemana {
  LUNES
  MARTES
  MIERCOLES
  JUEVES
  VIERNES
  SABADO
}

model Usuario {
  id              String   @id @default(uuid())
  nombre          String //Pendiente de migración
  apellido        String //Pendiente de migración
  dni             String
  fechaNacimiento DateTime
  email           String   @unique //Pendiente de migración
  password        String //Pendiente de migración
  rol             Rol

  cursosDictados   DocenteCurso[] @relation("DocenteCursos")
  cursosInscriptos AlumnoCurso[]  @relation("AlumnoCursos")

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  @@map("usuarios") // El nombre de la tabla en la BD
}

model Curso {
  id          String @id @default(uuid())
  nombre      String
  descripcion String
  claveAcceso String

  docentes  DocenteCurso[]
  alumnos   AlumnoCurso[]
  diasClase DiaClase[]

  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  deletedAt DateTime?

  @@map("cursos")
}

model DiaClase {
  id         String      @id @default(uuid())
  dia        DiaDeSemana
  horaInicio String
  horaFin    String
  modalidad  Modalidad

  curso   Curso  @relation(fields: [cursoId], references: [id], onDelete: Cascade)
  cursoId String

  @@index([cursoId])
  @@map("dias_clase") //Pendiente de migración
}

model DocenteCurso {
  curso     Curso   @relation(fields: [cursoId], references: [id])
  cursoId   String
  docente   Usuario @relation("DocenteCursos", fields: [docenteId], references: [id])
  docenteId String

  @@id([cursoId, docenteId])
  @@index([docenteId])
  @@map("docentes_cursos")
}

model AlumnoCurso {
  curso    Curso   @relation(fields: [cursoId], references: [id])
  cursoId  String
  alumno   Usuario @relation("AlumnoCursos", fields: [alumnoId], references: [id])
  alumnoId String

  @@id([cursoId, alumnoId])
  @@index([alumnoId])
  @@map("alumnos_cursos")
}
